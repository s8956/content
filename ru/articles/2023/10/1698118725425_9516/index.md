---
# -------------------------------------------------------------------------------------------------------------------- #
# General settings.
# -------------------------------------------------------------------------------------------------------------------- #

title: 'PowerShell: Полезные функции'
description: ''
images:
  - 'https://images.unsplash.com/photo-1510915228340-29c85a43dcfe'
categories:
  - 'windows'
  - 'terminal'
  - 'scripts'
tags:
  - 'powershell'
authors:
  - 'KitsuneSolar'
sources:
  - ''
license: 'CC-BY-SA-4.0'
complexity: '1'
toc: 1
comments: 1

# -------------------------------------------------------------------------------------------------------------------- #
# Date settings.
# -------------------------------------------------------------------------------------------------------------------- #

date: '2023-10-24T06:38:45+03:00'
publishDate: '2023-10-24T06:38:45+03:00'
expiryDate: ''
lastMod: '2023-10-24T06:38:45+03:00'

# -------------------------------------------------------------------------------------------------------------------- #
# Meta settings.
# -------------------------------------------------------------------------------------------------------------------- #

type: 'articles'
hash: 'c6e323498fc283f9da42790878a64076830f724f'
uuid: 'c6e32349-8fc2-53f9-9a42-790878a64076'
slug: 'c6e32349-8fc2-53f9-9a42-790878a64076'

draft: 0
---

Полезные функции PowerShell, которые я пишу сам или нахожу в интернете. Очень помогает в работе и в скриптах.

<!--more-->

## Найти файлы старше X дней с момента создания

Функция позволяет найти и вывести элементы старше X дней по свойству `CreationTime`.

### Параметры

- `-P` - путь к директории, в которой необходимо найти файлы.
- `-T` - время, прошедшее с момента создания файла (в секундах).

{{< file "pwsh.find.ct.ps1" >}}

{{< alert "tip" >}}
`.AddSeconds` можно заменить на `.AddDays`, чтобы отсчитывать дату не в секундах, а в днях.
{{< / alert >}}

## Найти файлы старше X дней с момента изменения

Функция позволяет найти и вывести элементы старше X дней по свойству `LastWriteTime`.

### Параметры

- `-P` - путь к директории, в которой необходимо найти файлы.
- `-T` - время, прошедшее с момента изменения файла (в секундах).

{{< alert "tip" >}}
`.AddSeconds` можно заменить на `.AddDays`, чтобы отсчитывать дату не в секундах, а в днях.
{{< / alert >}}

{{< file "pwsh.find.lwt.ps1" >}}

## Создать новый элемент

Функция позволяет создавать элементы. Ничего экстраординарного здесь нет, просто функция, укорачивающая стандартный cmdlet `New-Item`.

### Параметры

- `-T` - тип элемента.
  - `'D'` - директория.
  - `'F'` - файл.
- `-P` - путь к директории, в которой необходимо создать элемент.
- `-N` - название элемента.

{{< file "pwsh.new.item.ps1" >}}

## Проверить существование элемента

Функция позволяет "безопасно" проверить существование элемента. Применяется параметр `-LiteralPath`, который интерпретирует путь без какой-либо обработки.

### Параметры

- `-T` - тип элемента.
- `-P` - путь к директории, в которой необходимо проверить элемент.

{{< file "pwsh.test.item.ps1" >}}

## Проверить существование модуля

Функция позволяет проверить существование модуля PowerShell в памяти компьютера.

### Параметры

- `-N` - название модуля.

{{< file "pwsh.test.module.ps1" >}}

## Вывести сообщение в терминал

Функция выводит информацию в терминал по типу сообщений.

### Параметры

- `-T` - тип сообщения.
  - `'HL'` - заголовок.
  - `'I'` - информационное сообщение.
  - `'W'` - предупреждение (warning).
  - `'E'` - ошибка (error).
- `-M` - текст сообщения.
- `-A` - действие, которое необходимо выполнить при выводе сообщения в терминал.

{{< file "pwsh.write.msg.ps1" >}}

## Найти свободную букву диска

Небольшая функция, которая возвращает не занятую букву диска. Используется в {{< uuid "52d75b90-0637-5ba6-91d6-b1bff40e1d67" >}}.

{{< file "pwsh.find.adl.ps1" >}}

## Получить размер файла

Функция позволяет получить размер файла в различных единицах измерения.

### Параметры

- `-F` - название файла.

{{< file "pwsh.get.filesize.ps1" >}}

## Работа с архивами 7-Zip

Функции по работе с архивами 7-Zip.

### Параметры

- `-F` - путь к файлу.

### Упаковка

{{< file "pwsh.compress.7z.ps1" >}}

### Распаковка

{{< file "pwsh.expand.7z.ps1" >}}

## Работа с архивами WinRAR

Функции по работе с архивами WinRAR.

### Параметры

- `-F` - путь к файлу.

### Упаковка

{{< file "pwsh.compress.rar.ps1" >}}

### Распаковка

{{< file "pwsh.expand.rar.ps1" >}}
