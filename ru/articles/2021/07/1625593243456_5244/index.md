---
title: 'Зеркалирование репозитория между хостингами'
description: ''
images:
  - 'https://images.unsplash.com/photo-1611854571485-982a1f4ba294'
categories:
  - 'dev'
  - 'scripts'
tags:
  - 'git'
  - 'github'
  - 'gitlab'
  - 'mirror'
  - 'sync'
  - 'action'
authors:
  - 'KitsuneSolar'
license: 'CC-BY-SA-4.0'
complexity: '0'
toc: 1
comments: 1

date: '2021-07-06T20:40:43+03:00'

type: 'articles'
hash: '3834fbed71c8d97976c2236269f5ecea24083a24'
uuid: '3834fbed-71c8-5979-b6c2-236269f5ecea'
slug: '3834fbed-71c8-5979-b6c2-236269f5ecea'

draft: 0
---

В предыдущей статье {{< uuid "8544b8ce-4586-578f-9633-e8ae43441a25" >}} я рассказал о том, как организовать синхронизацию между репозиториями GIT на разных хостингах, в частности, между GitHub и GitLab. В итоге, я решил сделать [собственный GitHub Action](https://github.com/ghastore/github-mirror), который позволяет полностью зеркалировать репозитории.

<!--more-->

## Использование

Для подключения зеркалирования, к примеру, с GitHub на GitLab, необходимо в исходном репозитории создать файл `.github/workflows/mirror.yml`, в котором указать следующее содержимое:

{{< file "mirror.yml" >}}

- `src_repo` - **URL** исходного репозитория.
- `src_user` - **пользователь** исходного репозитория.
- `src_token` - **токен пользователя** исходного репозитория.
- `dsc_repo` - **URL** зеркального репозитория.
- `dsc_user` - **пользователь** зеркального репозитория.
- `dsc_token` - **токен пользователя** зеркального репозитория.

В этом коде стоит обратить внимание на параметр `target_repo`. GitLab позволяет автоматически создавать репозиторий при зеркалировании, а так как у меня адреса репозиториев совпадают между GitHub и GitLab, мне гораздо проще выстроить конструкцию `https://gitlab.com/${{ github.repository }}.git`. Переменная `${{ github.repository }}` содержит имя пользователя / организации и название репозитория, и, при настройке зеркалирования репозитория на GitHub'е, зеркало репозитория автоматически создаётся на GitLab'е.
